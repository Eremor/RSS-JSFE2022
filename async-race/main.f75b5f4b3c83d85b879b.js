(()=>{"use strict";var e={17:(e,t,n)=>{n.r(t)},202:(e,t,n)=>{n.r(t)},587:(e,t,n)=>{n.r(t)},136:(e,t,n)=>{n.r(t)},315:(e,t,n)=>{n.r(t)},958:(e,t,n)=>{n.r(t)},294:(e,t,n)=>{n.r(t)},403:(e,t,n)=>{n.r(t)},555:(e,t,n)=>{n.r(t)},708:(e,t,n)=>{n.r(t)},34:(e,t,n)=>{n.r(t)},426:(e,t,n)=>{n.r(t)},868:(e,t,n)=>{n.r(t)},717:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const s=n(493),a=n(881),o=n(290),r=n(498),i=n(200),d=n(704),c=n(458),l=n(520),u=n(262),h=n(597);t.App=class{rootElement;garage=new l.GaragePage;winners=new u.WinnersPage;constructor(e){this.rootElement=e}start=()=>{const e=new c.Header;e.draw();const t=document.createElement("main"),n=[()=>this.drawGaragePage(t),()=>this.drawGaragePage(t),()=>this.drawWinnersPage(t)],l=(0,i.getRouting)(["","garage","winners"],n);new a.Router(t,l).changeRout(),this.rootElement.append(e.node,t),s.garageState.updateCars(d.store.garagePage),o.winnerState.updateWinners(),r.observer.subscribe({action:"update garage",callback:this.garage.draw}),r.observer.subscribe({action:"show winner",callback:this.showWinner}),r.observer.subscribe({action:"update winners",callback:this.winners.draw})};drawGaragePage=e=>{e.append(this.garage.node)};drawWinnersPage=e=>{this.winners.draw(),e.append(this.winners.node)};showWinner=()=>{const{name:e,time:t}=d.store.newWinner,n=new h.Popup(e,t);n.draw(),this.rootElement.append(n.node)}}},672:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.API=void 0;const s=n(4);t.API=class{baseURL="http://127.0.0.1:3000";garage=`${this.baseURL}/garage`;winners=`${this.baseURL}/winners`;engine=`${this.baseURL}/engine`;getCars=async(e,t=s.CARS_PER_PAGE)=>{const n=await fetch(`${this.garage}?_page=${e}&_limit=${t}`);return{cars:await n.json(),count:+n.headers.get("X-Total-Count")}};getCar=async e=>(await fetch(`${this.garage}/${e}`)).json();createCar=async e=>{(await fetch(this.garage,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json()};deleteCar=async e=>{(await fetch(`${this.garage}/${e}`,{method:"DELETE"})).json()};updateCar=async e=>{const t=e.id;(await fetch(`${this.garage}/${t}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json()};startCarEngine=async e=>{const t=`${this.engine}?id=${e}&status=started`;return(await fetch(t,{method:"PATCH"})).json()};stopCarEngine=async e=>{const t=`${this.engine}?id=${e}&status=stopped`;await fetch(t,{method:"PATCH"})};race=async e=>{const t=`${this.engine}?id=${e}&status=drive`,n=await fetch(t,{method:"PATCH"});return 500===n.status&&console.error(`Oops!! The car with id="${e}" has a broken engine`),200!==n.status?{success:!1}:{success:!0}};createWinner=async e=>{await fetch(this.winners,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})};updateWinner=async e=>{const{id:t}=e,n=`${this.winners}/${t}`;await fetch(n,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})};getWinner=async e=>{const t=await fetch(`${this.winners}/${e}`),n=await t.json(),{status:s}=t;return{winner:n,status:s}};getWinners=async(e,t,n,a=s.WINNERS_PER_PAGE)=>{const o=`${this.winners}?_page=${e}&_limit=${a}&_sort=${t}&_order=${n}`,r=await fetch(o,{method:"GET"});return{winners:await r.json(),count:+r.headers.get("X-Total-Count")}};deleteWinner=async e=>{const{status:t}=await this.getWinner(e);200===t&&await fetch(`${this.winners}/${e}`,{method:"DELETE"})}}},493:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.garageState=void 0;const s=n(498),a=n(704),o=n(610),r=n(672);t.garageState=new class{api=new r.API;updateCars=async e=>{const{cars:t,count:n}=await this.api.getCars(e);a.store.cars=t,a.store.carsCount=n,s.observer.notify("update garage")};createCar=async(e,t)=>{if(!(e.length>0))throw new Error("Please provide a name for the car");await this.api.createCar({name:e,color:t}),this.updateCars(a.store.garagePage)};deleteCar=async e=>{await this.api.deleteCar(e),this.updateCars(a.store.garagePage)};updateCar=async e=>{await this.api.updateCar(e),this.updateCars(a.store.garagePage)};generateCars=async()=>{(0,o.generateRandomCars)(100).forEach((e=>{const{name:t,color:n}=e;this.createCar(t,n)})),this.updateCars(a.store.garagePage)}}},425:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.raceState=void 0;const s=n(704),a=n(610),o=n(672),r=n(290);t.raceState=new class{api=new o.API;startEngine=async e=>{const{car:t,flag:n}=(0,a.getRoad)(e),{distance:o,velocity:r}=await this.api.startCarEngine(e),i=Math.floor(o/r),d=Math.floor((0,a.getRaceDistance)(t,n))+40;s.store.animation[e]=(0,a.animation)(t,d,i);const{success:c}=await this.api.race(e);return c||window.cancelAnimationFrame(s.store.animation[e].id),{success:c,id:e,time:i}};stopEngine=async e=>{const{car:t}=(0,a.getRoad)(e);await this.api.stopCarEngine(e),t.setAttribute("style","transform: translate(0)"),s.store.animation[e]&&window.cancelAnimationFrame(s.store.animation[e].id)};race=async()=>{Promise.all(s.store.cars).then((e=>e.map((e=>this.startEngine(e.id))))).then((e=>{this.decideWinner(e)})).catch((e=>new Error(e)))};decideWinner=async e=>{Promise.all(e).then((e=>e.filter((e=>e.success)).sort(((e,t)=>e.time-t.time))[0])).then((e=>{r.winnerState.findWinner(e)}))};resetRace=async()=>{Promise.all(s.store.cars).then((e=>{e.forEach((e=>this.stopEngine(e.id)))}))}}},881:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0,t.Router=class{parentElement;routList;constructor(e,t){this.parentElement=e,this.routList=t,window.onpopstate=()=>{this.changeRout()}}changeRout=()=>{this.clearPage();const e=window.location.hash.slice(1);this.routList.find((t=>t.name===e)).onDraw()};clearPage=()=>{null!==this.parentElement.lastChild&&this.parentElement.removeChild(this.parentElement.lastChild)}}},290:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.winnerState=void 0;const s=n(498),a=n(704),o=n(672);t.winnerState=new class{api=new o.API;findWinner=async e=>{const{id:t,time:n}=e,s=+(n/1e3).toFixed(2);await this.saveWinner(t,s),await this.showWinner(t,s),await this.updateWinners()};saveWinner=async(e,t)=>{const{winner:n,status:s}=await this.api.getWinner(e);404===s?(console.error(`Car with id="${e}", won first time`),await this.api.createWinner({id:e,time:t,wins:1})):await this.api.updateWinner({id:n.id,wins:n.wins+=1,time:t<n.time?t:n.time})};showWinner=async(e,t)=>{const n=a.store.cars.find((t=>t.id===e));a.store.newWinner={name:n.name,time:t},s.observer.notify("show winner"),a.store.isFinish=!0,s.observer.notify("update control race")};findWinnerCar=async e=>{const t=await this.api.getCar(e);a.store.findWinnerCar=t};updateWinners=async()=>{const{sortBy:e,order:t}=a.store.sort,{winners:n,count:o}=await this.api.getWinners(a.store.winnersPage,e,t);a.store.winners=n,a.store.winnersCount=o,s.observer.notify("update winners")};deleteWinner=async e=>{await this.api.deleteWinner(e),this.updateWinners()}}},4:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WINNERS_PER_PAGE=t.CARS_PER_PAGE=void 0,t.CARS_PER_PAGE=7,t.WINNERS_PER_PAGE=10},498:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.observer=void 0,t.observer=new class{listeners=[];subscribe=e=>{this.listeners.push(e)};unsubscribe=e=>{this.listeners=this.listeners.filter((t=>t!==e))};notify=e=>{this.listeners.forEach((t=>{t.action===e&&t.callback()}))}}},200:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRouting=void 0,t.getRouting=(e,t)=>{const n=[];for(let s=0;s<e.length;s+=1){const a={name:e[s],onDraw:t[s]};n.push(a)}return n}},704:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.store=void 0,t.store={garagePage:1,cars:[],carsCount:4,newCar:{name:"",color:"#ffffff"},selectCar:{name:"",color:"#ffffff"},isSelected:!1,isActiveEngine:!1,isRace:!1,isFinish:!1,animation:[],carsAtRace:[],newWinner:{name:"",time:0},winnersPage:1,winners:[],winnersCount:1,findWinnerCar:{name:"",color:""},sort:{sortBy:"",order:"ASC",isDuplicated:!1}}},610:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRoad=t.animation=t.getRaceDistance=t.generateRandomCars=void 0;const s=n(704),a=["Audi","BMW","Ford","Honda","Hyundai","Kia","Mazda","Mercedes","Toyota","Volkswagen"],o=["Q7","A7","X6","3","Accord","Civic","i30","Solaris","Rio","Sorento","CX5","RX 8","SLK","GLE","Camry","Celica","Polo","Golf"],r=()=>{const e="0123456789ABCDEF";let t="#";for(let n=0;n<6;n+=1)t+=e[Math.floor(Math.random()*e.length)];return t};t.generateRandomCars=e=>new Array(e).fill({name:"",color:""}).map((()=>({name:`${a[Math.floor(Math.random()*a.length)]} ${o[Math.floor(Math.random()*o.length)]}`,color:r()})));const i=e=>{const{top:t,left:n,width:s,height:a}=e.getBoundingClientRect();return{x:n+s/2,y:t+a/2}};t.getRaceDistance=(e,t)=>{const n=i(e),s=i(t);return Math.hypot(n.x-s.x,n.y-s.y)},t.animation=(e,t,n)=>{let s=null;const a={id:0},o=r=>{s||(s=r);const i=r-s,d=Math.round(i*(t/n)),c=`transform: translate(${Math.min(d,t)}px)`;e.setAttribute("style",`${c}`),d<t&&(a.id=window.requestAnimationFrame(o))};return a.id=window.requestAnimationFrame(o),a},t.getRoad=e=>{const t=s.store.carsAtRace.find((t=>+t.id===e)).children[1];return{car:t.children[1],flag:t.children[2]}}},731:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponent=void 0,t.BaseComponent=class{node;constructor(e="div",t=[]){this.node=document.createElement(e),this.node.classList.add(...t)}}},749:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CarImage=void 0;const s=n(731);class a extends s.BaseComponent{constructor(e){super("div",["car__image"]),this.node.innerHTML=`\n      <?xml version="1.0" encoding="iso-8859-1"?>\n      <svg version="1.1" id="sport-car" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n        width="70px" height="90px" viewBox="0 0 95 90" style="transform: scale(-1, 1)" fill=${e}\n        xml:space="preserve">\n      <g>\n        <g>\n          <path d="M21.569,50.122c-3.994,0.039-7.199,3.305-7.161,7.299c0.003,0.312,0.029,0.611,0.071,0.91\n            c0.482,3.562,3.542,6.289,7.228,6.252c3.787-0.035,6.859-2.973,7.138-6.68c0.015-0.205,0.028-0.41,0.026-0.617\n            C28.833,53.29,25.564,50.084,21.569,50.122z M20.971,52.874l0.019,2.08c-0.228,0.062-0.438,0.152-0.637,0.273l-1.486-1.459\n            C19.468,53.301,20.183,52.989,20.971,52.874z M17.991,54.663l1.488,1.461c-0.111,0.199-0.2,0.412-0.255,0.637l-2.079,0.023\n            C17.245,55.993,17.539,55.272,17.991,54.663z M17.148,58.034l2.095-0.02c0.062,0.223,0.15,0.432,0.268,0.625l-1.465,1.491\n            C17.586,59.534,17.267,58.817,17.148,58.034z M18.949,61.002l1.457-1.485c0.193,0.108,0.407,0.192,0.63,0.248l0.019,2.086\n            C20.272,61.75,19.555,61.448,18.949,61.002z M26.122,56.698l-2.08,0.02c-0.059-0.227-0.15-0.438-0.269-0.635l1.462-1.49\n            C25.698,55.194,26.006,55.909,26.122,56.698z M22.222,52.862c0.791,0.102,1.512,0.4,2.12,0.854l-1.458,1.484\n            c-0.198-0.115-0.413-0.203-0.643-0.262L22.222,52.862z M22.308,61.838l-0.02-2.086c0.223-0.059,0.432-0.145,0.625-0.262\n            l1.483,1.459C23.8,61.409,23.089,61.724,22.308,61.838z M25.285,60.065l-1.495-1.467c0.11-0.195,0.205-0.404,0.263-0.632\n            l2.076-0.02C26.027,58.733,25.739,59.461,25.285,60.065z"/>\n          <path d="M79.957,50.122c-3.994,0.039-7.199,3.305-7.161,7.299c0.003,0.312,0.029,0.611,0.071,0.91\n            c0.481,3.562,3.542,6.289,7.228,6.252c3.786-0.035,6.859-2.973,7.138-6.68c0.016-0.205,0.028-0.41,0.026-0.617\n            C87.221,53.29,83.952,50.084,79.957,50.122z M79.357,52.874l0.02,2.08c-0.229,0.062-0.438,0.152-0.637,0.273l-1.486-1.459\n            C77.854,53.301,78.568,52.989,79.357,52.874z M76.379,54.663l1.488,1.461c-0.112,0.199-0.2,0.412-0.256,0.637l-2.078,0.023\n            C75.633,55.993,75.927,55.272,76.379,54.663z M75.536,58.034l2.095-0.02c0.062,0.223,0.149,0.432,0.268,0.625l-1.465,1.491\n            C75.974,59.534,75.653,58.817,75.536,58.034z M77.337,61.002l1.457-1.485c0.192,0.108,0.407,0.192,0.629,0.248l0.02,2.086\n            C78.66,61.75,77.941,61.448,77.337,61.002z M84.51,56.698l-2.08,0.02c-0.059-0.227-0.15-0.438-0.269-0.635l1.462-1.49\n            C84.086,55.194,84.394,55.909,84.51,56.698z M80.608,52.862c0.79,0.102,1.513,0.4,2.12,0.854l-1.458,1.484\n            c-0.197-0.115-0.413-0.203-0.643-0.262L80.608,52.862z M80.694,61.838l-0.02-2.086c0.223-0.059,0.432-0.145,0.625-0.262\n            l1.483,1.459C82.188,61.409,81.477,61.724,80.694,61.838z M83.673,60.065l-1.495-1.467c0.11-0.195,0.205-0.404,0.263-0.632\n            l2.076-0.02C84.415,58.733,84.127,59.461,83.673,60.065z"/>\n          <path d="M99.122,42.375c-0.117-0.146-0.295-0.233-0.483-0.233h-6.388c-0.253,0-0.48,0.156-0.572,0.393l-0.407,1.045\n            c0,0-18.024-6.571-22.044-7.969c-3.117-1.084-11.719-1.004-16.776-0.849c-2.492,0.077-4.985,0.59-7.301,1.516\n            c-4.257,1.701-11.383,4.628-15.049,6.584c-8.715,0.184-16.877,2.165-18.686,3.039c-1.808,0.875-5.714,4.374-5.714,4.374\n            l-4.724,2.489c-0.644,0.34-1.025,1.028-0.972,1.756l0.283,3.816c0.063,0.854,0.708,1.547,1.553,1.676l11.253,1.697l0.926-0.038\n            c-0.539-0.945-0.912-2.003-1.065-3.135c-0.054-0.383-0.082-0.745-0.086-1.1c-0.046-4.835,3.85-8.807,8.686-8.854\n            c4.876,0,8.809,3.897,8.854,8.688c0.002,0.251-0.012,0.498-0.029,0.746c-0.081,1.067-0.362,2.081-0.796,3.01l42.45-0.088\n            c-0.339-0.749-0.577-1.555-0.691-2.401c-0.054-0.383-0.083-0.745-0.086-1.1c-0.046-4.835,3.85-8.807,8.686-8.854\n            c4.875,0,8.81,3.897,8.854,8.688c0.002,0.251-0.012,0.498-0.03,0.746c-0.042,0.563-0.139,1.114-0.285,1.646l0.395-0.031\n            l7.636-2.291c0.698-0.209,1.205-0.812,1.293-1.534l0.682-5.691c0.086-0.717-0.062-1.44-0.422-2.066l-1.281-2.23l1.979-1.503\n            c0.114-0.087,0.194-0.21,0.229-0.35l0.25-1.064C99.28,42.715,99.237,42.522,99.122,42.375z M64.787,43.424l-19.354,0.569\n            c0,0-0.003-2.387-2.864-2.684l4.563-2.703c1.649-0.978,3.512-1.476,5.429-1.461c3.491,0.027,9.276,0.092,12.691,0.238\n            c0.606,0.025,1.158,0.363,1.458,0.892c0.3,0.529,0.306,1.176,0.015,1.71C65.77,41.743,64.787,43.424,64.787,43.424z"/>\n        </g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      </svg>\n    `}}t.CarImage=a},314:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Car=void 0;const s=n(731),a=n(533),o=n(529);n(17);class r extends s.BaseComponent{carName;carColor;carId;constructor(e){super("li",["garage__car","car"]),this.carName=e.name,this.carColor=e.color,this.carId=e.id,this.node.id=`${this.carId}`}draw=()=>{const e=new a.CarControl(this.carName,this.carId);e.draw();const t=new o.Road(this.carColor,this.carId);t.draw(),this.node.append(e.node,t.node)}}t.Car=r},533:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CarControl=void 0;const s=n(493),a=n(290),o=n(498),r=n(704),i=n(731),d=n(766);class c extends i.BaseComponent{name;id;constructor(e,t){super("div",["car__control"]),this.name=e,this.id=t}draw=()=>{const e=new d.Button(["btn--light","car__select","car__btn"],"select"),t=new d.Button(["btn--light","car__remove","car__btn"],"remove"),n=document.createElement("h4");n.classList.add("car__name"),n.textContent=this.name,this.node.append(e.node,t.node,n),e.onClick(this.selectCar),t.onClick(this.removeCar)};selectCar=()=>{const e=r.store.cars.find((e=>e.id===this.id));r.store.selectCar=e,r.store.isSelected=!0,o.observer.notify("update garage")};removeCar=()=>{r.store.selectCar={name:"",color:"#ffffff"},r.store.isSelected=!1,s.garageState.deleteCar(this.id),a.winnerState.deleteWinner(this.id)}}t.CarControl=c},398:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Engine=void 0;const s=n(425),a=n(704),o=n(731),r=n(766);n(202);class i extends o.BaseComponent{id;startEngineButton;stopEngineButton;constructor(e){super("div",["engine"]),this.id=e,this.startEngineButton=new r.Button(["engine__btn","engine__btn--start"],"A"),this.stopEngineButton=new r.Button(["engine__btn","engine__btn--stop","engine__btn--disabled"],"B")}draw=()=>{this.node.append(this.startEngineButton.node,this.stopEngineButton.node),this.startEngineButton.onClick(this.startEngine),this.stopEngineButton.onClick(this.stopEngine)};startEngine=()=>{a.store.isActiveEngine=!0,this.isDisabled(a.store.isActiveEngine),s.raceState.startEngine(this.id)};stopEngine=()=>{a.store.isActiveEngine=!1,this.isDisabled(a.store.isActiveEngine),s.raceState.stopEngine(this.id)};isDisabled=e=>{e?(this.disabledButton(this.startEngineButton.node),this.activeButton(this.stopEngineButton.node)):(this.activeButton(this.startEngineButton.node),this.disabledButton(this.stopEngineButton.node))};disabledButton=e=>{e.classList.add("engine__btn--disabled"),e.setAttribute("disabled","true")};activeButton=e=>{e.classList.remove("engine__btn--disabled"),e.removeAttribute("disabled")}}t.Engine=i},529:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Road=void 0;const s=n(731),a=n(749),o=n(398);n(587);class r extends s.BaseComponent{color;id;constructor(e,t){super("div",["road"]),this.color=e,this.id=t}draw=()=>{const e=new a.CarImage(this.color),t=document.createElement("div");t.classList.add("road__flag");const n=new o.Engine(this.id);n.draw(),this.node.append(n.node,e.node,t)}}t.Road=r},458:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const s=n(731),a=n(211);n(136);class o extends s.BaseComponent{constructor(){super("header",["header"])}draw=()=>{const e=new a.RouterLink("To garage","garage"),t=new a.RouterLink("To winners","winners");this.node.append(e.node,t.node)}}t.Header=o},840:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Body=void 0;const s=n(704),a=n(731),o=n(314),r=n(346),i=n(6);class d extends a.BaseComponent{constructor(){super("div",["garage__body"])}draw=()=>{this.node.innerHTML="";const e=new i.Title(`Garage (${s.store.carsCount})`),t=new r.SubTitle(`Page #${s.store.garagePage}`),n=document.createElement("ul");n.classList.add("garage__list"),n.innerHTML="",this.drawCars(n),this.node.append(e.node,t.node,n)};drawCars=e=>{s.store.carsAtRace=[],s.store.cars.forEach((t=>{const n=new o.Car(t);n.draw(),s.store.carsAtRace.push(n.node),e.append(n.node)}))}}t.Body=d},256:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Control=void 0;const s=n(493),a=n(425),o=n(704),r=n(731),i=n(766);class d extends r.BaseComponent{startRaceButton=new i.Button(["btn--primary"],"race");resetRaceButton=new i.Button(["btn--primary","btn--disabled"],"reset");generateCarsButton=new i.Button(["btn--light"],"generate cars");constructor(){super("div",["garage__control"])}draw=()=>{this.node.append(this.startRaceButton.node,this.resetRaceButton.node,this.generateCarsButton.node),this.resetRaceButton.node.disabled=!0,this.startRaceButton.onClick(this.startRace),this.resetRaceButton.onClick(this.resetRace),this.generateCarsButton.onClick(this.generateCars),this.isDisabled(o.store.isRace,this.startRaceButton),this.isDisabled(!o.store.isFinish,this.resetRaceButton)};startRace=()=>{o.store.isRace=!0,this.isDisabled(o.store.isRace,this.startRaceButton),a.raceState.race()};resetRace=()=>{o.store.isRace=!1,o.store.isFinish=!1,this.isDisabled(!o.store.isFinish,this.resetRaceButton),this.isDisabled(o.store.isRace,this.startRaceButton),a.raceState.resetRace()};isDisabled=(e,t)=>{e?this.disabledButton(t.node):this.activeButton(t.node)};disabledButton=e=>{e.classList.add("btn--disabled"),e.setAttribute("disabled","true")};activeButton=e=>{e.classList.remove("btn--disabled"),e.removeAttribute("disabled")};generateCars=()=>{s.garageState.generateCars()}}t.Control=d},520:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GaragePage=void 0;const s=n(731),a=n(840),o=n(604),r=n(702),i=n(704);n(315);class d extends s.BaseComponent{constructor(){super("section",["garage"])}draw=()=>{this.node.innerHTML="";const e=new o.Menu;e.draw();const t=new a.Body;t.draw();const n=new r.Pagination(i.store.garagePage,i.store.carsCount,7);n.draw(),this.node.append(e.node,t.node,n.node)}}t.GaragePage=d},604:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Menu=void 0;const s=n(493),a=n(498),o=n(704),r=n(731),i=n(174),d=n(256);class c extends r.BaseComponent{createCarForm=new i.Form(["form--create","garage__form"],"create",o.store.newCar);updateCarForm=new i.Form(["form--update","garage__form"],"update",o.store.selectCar);constructor(){super("div",["garage__menu"])}draw=()=>{this.createCarForm.draw(),this.updateCarForm.draw(),this.updateCarForm.isDisabled(o.store.isSelected);const e=new d.Control;e.draw(),this.node.append(this.createCarForm.node,this.updateCarForm.node,e.node),this.createCarForm.onSubmit(this.createCar),this.updateCarForm.onSubmit(this.updateCar),a.observer.subscribe({action:"update control race",callback:e.draw})};createCar=()=>{const{name:e,color:t}=o.store.newCar;s.garageState.createCar(e,t),this.createCarForm.clear(),a.observer.notify("update garage")};updateCar=()=>{s.garageState.updateCar(o.store.selectCar),o.store.isSelected=!1,this.updateCarForm.clear()}}t.Menu=c},428:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Container=void 0;const s=n(704),a=n(731),o=n(346),r=n(6),i=n(636);class d extends a.BaseComponent{constructor(){super("div",["winners__body"])}draw=()=>{this.node.innerHTML="";const e=new r.Title(`Winners (${s.store.winnersCount})`),t=new o.SubTitle(`Page #${s.store.winnersPage}`),n=new i.Table;n.draw(),this.node.append(e.node,t.node,n.node)}}t.Container=d},337:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BodyTable=void 0;const s=n(290),a=n(704),o=n(731),r=n(189);class i extends o.BaseComponent{constructor(){super("ul",["table__body"])}draw=()=>{this.node.innerHTML="",this.drawWinners(this.node)};drawWinners=e=>{a.store.winners.forEach((async(t,n)=>{const{id:o,time:i,wins:d}=t;await s.winnerState.findWinnerCar(o);const{name:c,color:l}=a.store.findWinnerCar,u={id:o,position:n+1+10*(a.store.winnersPage-1),color:l,name:c,time:i,wins:d},h=new r.WinnerItem(u);h.draw(),e.append(h.node)}))}}t.BodyTable=i},738:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderTable=void 0;const s=n(290),a=n(704),o=n(731),r=n(766);class i extends o.BaseComponent{winsButton=new r.Button(["table__col","table__col--bg","table__col--btn"],"Wins");bestTimeButton=new r.Button(["table__col","table__col--bg","table__col--btn"],"Best time (seconds)");constructor(){super("div",["table__header"])}draw=()=>{const e=document.createElement("p");e.classList.add("table__col","table__col--bg"),e.textContent="Number";const t=document.createElement("p");t.classList.add("table__col","table__col--bg"),t.textContent="Car";const n=document.createElement("p");n.classList.add("table__col","table__col--bg"),n.textContent="Name",this.winsButton.node.dataset.sort="wins",this.bestTimeButton.node.dataset.sort="time",this.node.append(e,t,n,this.winsButton.node,this.bestTimeButton.node),this.winsButton.onClick(this.sortByWins),this.bestTimeButton.onClick(this.sortByTime),this.toggleClass(this.winsButton.node),this.toggleClass(this.bestTimeButton.node)};sortByWins=()=>{this.sortData(this.winsButton)};sortByTime=()=>{this.sortData(this.bestTimeButton)};toggleClass=e=>{this.removeClass(this.winsButton.node),this.removeClass(this.bestTimeButton.node),e.dataset.sort===a.store.sort.sortBy&&(a.store.sort.isDuplicated?e.classList.add("active-reverse"):e.classList.add("active"))};removeClass=e=>{a.store.sort.sortBy!==e.dataset.sort&&(a.store.sort.isDuplicated?e.classList.remove("active"):e.classList.remove("active-reverse"))};sortData=e=>{const t=e.node.dataset.sort,n=a.store.sort.isDuplicated;a.store.sort.sortBy===t?(a.store.sort.isDuplicated=!n,a.store.sort.order="DESC"):(a.store.sort.sortBy=t,a.store.sort.order="ASC",a.store.sort.isDuplicated=!1),a.store.sort.order=n?"DESC":"ASC",this.toggleClass(e.node),s.winnerState.updateWinners()}}t.HeaderTable=i},636:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Table=void 0;const s=n(731),a=n(337),o=n(738);n(958);class r extends s.BaseComponent{constructor(){super("div",["winners__table","table"])}draw=()=>{const e=new o.HeaderTable;e.draw();const t=new a.BodyTable;t.draw(),this.node.append(e.node,t.node)}}t.Table=r},189:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnerItem=void 0;const s=n(731),a=n(749);class o extends s.BaseComponent{winner;constructor(e){super("li",["table__row"]),this.winner=e}draw=()=>{const{id:e,position:t,color:n,name:s,wins:o,time:r}=this.winner;this.node.setAttribute("id",`${e}`);const i=document.createElement("span");i.classList.add("table__col","table__col--number"),i.textContent=`${t}`;const d=new a.CarImage(n);d.node.classList.remove("car__image"),d.node.classList.add("table__col","table__col--car");const c=document.createElement("span");c.classList.add("table__col","table__col--name"),c.textContent=s;const l=document.createElement("span");l.classList.add("table__col","table__col--wins"),l.textContent=`${o}`;const u=document.createElement("span");u.classList.add("table__col","table__col--score"),u.textContent=`${r}`,this.node.append(i,d.node,c,l,u)}}t.WinnerItem=o},262:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnersPage=void 0;const s=n(704),a=n(731),o=n(702),r=n(428);n(294);class i extends a.BaseComponent{constructor(){super("section",["winners"])}draw=()=>{this.node.innerHTML="";const e=new r.Container;e.draw();const t=new o.Pagination(s.store.winnersPage,s.store.winnersCount,10);t.draw(),this.node.append(e.node,t.node)}}t.WinnersPage=i},597:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Popup=void 0;const s=n(731),a=n(766);n(403);class o extends s.BaseComponent{text;button=new a.Button(["btn--primary"],"ok");constructor(e,t){super("div",["popup"]),this.text=document.createElement("p"),this.text.classList.add("popup__text"),this.text.textContent=`${e} arrived first [ ${t}s ]`}draw=()=>{this.node.append(this.text,this.button.node),this.button.onClick(this.closePopup)};closePopup=()=>{this.node.remove()}}t.Popup=o},211:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RouterLink=void 0;const s=n(766);class a extends s.Button{constructor(e,t){super(["btn--primary","header__route"],e),this.node.dataset.route=t,this.onClick(this.changeLink)}changeLink=e=>{const{target:t}=e;t.classList.contains("header__route")&&(window.location.hash=t.dataset.route)}}t.RouterLink=a},766:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;const s=n(731);n(555);class a extends s.BaseComponent{constructor(e,t){super("button",["btn",...e]),this.node.textContent=t}onClick=e=>{this.node.addEventListener("click",e)}}t.Button=a},174:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Form=void 0;const s=n(731),a=n(766),o=n(70);n(708);class r extends s.BaseComponent{btnName;text=new o.Input(["form__name"],"text");color=new o.Input(["form__color"],"color");button=new a.Button(["btn--light"],"");store;constructor(e,t,n){super("font",["form",...e]),this.btnName=t,this.store=n}draw=()=>{this.text.draw(this.store.name),this.color.draw(this.store.color),this.button.node.textContent=this.btnName,this.node.append(this.text.node,this.color.node,this.button.node),this.node.addEventListener("input",this.onChange)};onSubmit=e=>{this.button.onClick(e)};onChange=()=>{this.store.name=this.text.node.value,this.store.color=this.color.node.value};isDisabled=e=>{e?(this.activeElement(this.text.node),this.activeElement(this.color.node),this.activeElement(this.button.node)):(this.disabledElement(this.text.node),this.disabledElement(this.color.node),this.disabledElement(this.button.node))};disabledElement=e=>{e.classList.add("form--disabled"),e.setAttribute("disabled","true"),e.classList.contains("btn")&&e.classList.add("btn--disabled")};activeElement=e=>{e.classList.remove("form--disabled"),e.removeAttribute("disabled"),e.classList.contains("btn")&&e.classList.remove("btn--disabled")};get textValue(){return this.text.node.value}set textValue(e){this.text.node.value=e}get colorValue(){return this.color.node.value}set colorValue(e){this.color.node.value=e}clear=()=>{this.store.name="",this.store.color="#ffffff"}}t.Form=r},346:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SubTitle=void 0;const s=n(731);n(34);class a extends s.BaseComponent{constructor(e){super("h3",["subtitle"]),this.node.textContent=e}}t.SubTitle=a},6:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Title=void 0;const s=n(731);n(34);class a extends s.BaseComponent{constructor(e){super("h2",["title"]),this.node.textContent=e}}t.Title=a},70:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Input=void 0;const s=n(731);class a extends s.BaseComponent{constructor(e,t){super("input",[...e]),this.node.setAttribute("type",t)}draw=e=>{this.node.value=e}}t.Input=a},702:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Pagination=void 0;const s=n(493),a=n(290),o=n(704),r=n(731),i=n(766);n(426);class d extends r.BaseComponent{pageNumber;lastPage;prevButton=new i.Button(["btn--primary"],"Prev");nextButton=new i.Button(["btn--primary"],"Next");elementPerPage;constructor(e,t,n){super("div",["pagination"]),this.pageNumber=e,this.elementPerPage=n,this.lastPage=Math.ceil(t/n)}draw=()=>{this.pageNumber<=1&&this.disabledButton(this.prevButton.node),this.pageNumber>=this.lastPage&&this.disabledButton(this.nextButton.node),this.node.append(this.prevButton.node,this.nextButton.node),this.prevButton.onClick(this.moveToPrevPage),this.nextButton.onClick(this.moveToNextPage)};moveToPrevPage=()=>{this.pageNumber>1?(this.activeButton(this.prevButton.node),this.pageNumber-=1):this.disabledButton(this.prevButton.node),this.setPage(this.pageNumber)};moveToNextPage=()=>{this.pageNumber<this.lastPage?(this.activeButton(this.nextButton.node),this.pageNumber+=1):this.disabledButton(this.nextButton.node),this.setPage(this.pageNumber)};activeButton=e=>{e.classList.remove("btn--disabled"),e.setAttribute("disabled","false")};disabledButton=e=>{e.classList.add("btn--disabled"),e.setAttribute("disabled","true")};setPage=e=>{7===this.elementPerPage&&(o.store.garagePage=e,s.garageState.updateCars(e)),10===this.elementPerPage&&(o.store.winnersPage=e,a.winnerState.updateWinners())}}t.Pagination=d}},t={};function n(s){var a=t[s];if(void 0!==a)return a.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,n),o.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=n(717);n(868),window.onload=()=>{new e.App(document.body).start()}})()})();
//# sourceMappingURL=main.f75b5f4b3c83d85b879b.js.map